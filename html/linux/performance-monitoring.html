

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Performance monitoring &mdash; Geoffrey&#39;s TIL 0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Enable “Tap to click” touch pad" href="package-managers.html" />
    <link rel="prev" title="Mount" href="mount.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Geoffrey's TIL
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ansible/_.html">Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archlinux/_.html">ArchLinux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash/_.html">Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/_.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-env/_.html">Development environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/_.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/_.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/_.html">Golang</a></li>
<li class="toctree-l1"><a class="reference internal" href="../influxdb/_.html">InfluxDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java/_.html">Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/_.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kvm/_.html">KVM</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_.html">Linux</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arp.html">arp</a></li>
<li class="toctree-l2"><a class="reference internal" href="bluetooth.html">bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="cgroup.html">cgroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="dd.html">dd</a></li>
<li class="toctree-l2"><a class="reference internal" href="directories-most-files.html">Directories with most files</a></li>
<li class="toctree-l2"><a class="reference internal" href="disable-touch-pad-while-typing.html">Disable touchpad while typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="disk-usage.html">Disk Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">E-Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="enable-tap-click-touch-pad.html">Enable “Tap to click” touch pad</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-permissions.html">File Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="find-delete-files.html">find: delete files</a></li>
<li class="toctree-l2"><a class="reference internal" href="hard-disk-management.html">Hard Disk Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-date.html">Installation date</a></li>
<li class="toctree-l2"><a class="reference internal" href="journalctl.html">journalctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="journalctl-size.html">journalctl size</a></li>
<li class="toctree-l2"><a class="reference internal" href="mount.html">Mount</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Performance monitoring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#processes">Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-system-and-i-o">File system and I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="#network-stats">Network stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#network-traffic-analysis">Network traffic analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-average">Load average</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="package-managers.html">Enable “Tap to click” touch pad</a></li>
<li class="toctree-l2"><a class="reference internal" href="recursive-md5.html">Recursive md5</a></li>
<li class="toctree-l2"><a class="reference internal" href="reset-root-password.html">Reset Root Password</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpm.html">RPM Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsync.html">rsync</a></li>
<li class="toctree-l2"><a class="reference internal" href="simple-http-server.html">Simple HTTP Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh-remove-hostname.html">SSH Remove hostname</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh-tunnels.html">SSH Tunnels</a></li>
<li class="toctree-l2"><a class="reference internal" href="sudo-timeout.html">sudo timeouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="netstat.html">netstat</a></li>
<li class="toctree-l2"><a class="reference internal" href="tcpdump-filters.html">tcpdump: filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-power.html">USB Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="user-management-cheatsheet.html">User Management Cheatsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="vi-write-sudo.html">vi: write as sudo</a></li>
<li class="toctree-l2"><a class="reference internal" href="vnc-server.html">VNC Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="yum.html">yum</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs.html">ZFS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../markdown/_.html">Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/_.html">Media</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mysql/_.html">Mysql</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/_.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodejs/_.html">NodeJS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../php/_.html">PHP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postgres/_.html">Postgres</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/_.html">Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/_.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rfc/_.html">RFCs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sphinx/_.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scala/_.html">Scala</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tmux/_.html">tmux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ubuntu-debian/_.html">Ubuntu / Debian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vim/_.html">vim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/_.html">Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wine/_.html">Wine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zsh/_.html">zsh</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Geoffrey's TIL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_.html">Linux</a> &raquo;</li>
        
      <li>Performance monitoring</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/linux/performance-monitoring.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="performance-monitoring">
<h1>Performance monitoring<a class="headerlink" href="#performance-monitoring" title="Permalink to this headline">¶</a></h1>
<p>This TIL will be a bit longer because it aims to list some of the most useful and most important performance monitoring tools available on Linux. Some are usually installed by default and some must be installed manually.</p>
<p>The tools are split into several categories.</p>
<p>The base of this page has been constructed by selecting information from: <a class="reference external" href="https://www.tecmint.com/command-line-tools-to-monitor-linux-performance/">https://www.tecmint.com/command-line-tools-to-monitor-linux-performance/</a>. It has then been enhanced based on my personal preference and uses.</p>
<section id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<p>This section shows tools displaying general information about the system state and usage.
When troubleshooting a Linux machine, these are the tools to be inspected first.</p>
<p><strong>top</strong></p>
<p>The first tool to execute, to inspect te running process on a system interactively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">top</span> <span class="o">-</span> <span class="mi">06</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">14</span> <span class="n">up</span> <span class="mi">1</span> <span class="n">day</span><span class="p">,</span> <span class="mi">23</span><span class="p">:</span><span class="mi">04</span><span class="p">,</span>  <span class="mi">1</span> <span class="n">user</span><span class="p">,</span>  <span class="n">load</span> <span class="n">average</span><span class="p">:</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">1.12</span>
<span class="n">Tasks</span><span class="p">:</span> <span class="mi">220</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">1</span> <span class="n">running</span><span class="p">,</span> <span class="mi">219</span> <span class="n">sleeping</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">stopped</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">zombie</span>
<span class="o">%</span><span class="n">Cpu</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>  <span class="mf">2.9</span> <span class="n">us</span><span class="p">,</span>  <span class="mf">0.7</span> <span class="n">sy</span><span class="p">,</span>  <span class="mf">0.0</span> <span class="n">ni</span><span class="p">,</span> <span class="mf">95.9</span> <span class="nb">id</span><span class="p">,</span>  <span class="mf">0.0</span> <span class="n">wa</span><span class="p">,</span>  <span class="mf">0.3</span> <span class="n">hi</span><span class="p">,</span>  <span class="mf">0.1</span> <span class="n">si</span><span class="p">,</span>  <span class="mf">0.0</span> <span class="n">st</span>
<span class="n">MiB</span> <span class="n">Mem</span> <span class="p">:</span>   <span class="mf">7879.9</span> <span class="n">total</span><span class="p">,</span>    <span class="mf">814.6</span> <span class="n">free</span><span class="p">,</span>   <span class="mf">2198.2</span> <span class="n">used</span><span class="p">,</span>   <span class="mf">4867.1</span> <span class="n">buff</span><span class="o">/</span><span class="n">cache</span>
<span class="n">MiB</span> <span class="n">Swap</span><span class="p">:</span>   <span class="mf">2294.0</span> <span class="n">total</span><span class="p">,</span>   <span class="mf">2271.5</span> <span class="n">free</span><span class="p">,</span>     <span class="mf">22.5</span> <span class="n">used</span><span class="o">.</span>   <span class="mf">5041.8</span> <span class="n">avail</span> <span class="n">Mem</span>

  <span class="n">PID</span> <span class="n">USER</span>      <span class="n">PR</span>  <span class="n">NI</span>    <span class="n">VIRT</span>    <span class="n">RES</span>    <span class="n">SHR</span> <span class="n">S</span>  <span class="o">%</span><span class="n">CPU</span>  <span class="o">%</span><span class="n">MEM</span>     <span class="n">TIME</span><span class="o">+</span> <span class="n">COMMAND</span>
 <span class="mi">1034</span> <span class="n">john</span>      <span class="mi">20</span>   <span class="mi">0</span> <span class="mi">4007988</span> <span class="mi">373052</span> <span class="mi">120692</span> <span class="n">S</span>   <span class="mf">8.6</span>   <span class="mf">4.6</span>   <span class="mi">6</span><span class="p">:</span><span class="mf">07.41</span> <span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
<span class="mi">10943</span> <span class="n">john</span>      <span class="mi">20</span>   <span class="mi">0</span> <span class="mi">9240860</span> <span class="mi">653416</span> <span class="mi">143408</span> <span class="n">S</span>   <span class="mf">3.3</span>   <span class="mf">8.1</span>   <span class="mi">3</span><span class="p">:</span><span class="mf">39.64</span> <span class="n">firefox</span>
 <span class="mi">1352</span> <span class="n">john</span>      <span class="mi">20</span>   <span class="mi">0</span>  <span class="mi">503356</span>  <span class="mi">43776</span>  <span class="mi">32716</span> <span class="n">S</span>   <span class="mf">1.0</span>   <span class="mf">0.5</span>   <span class="mi">0</span><span class="p">:</span><span class="mf">06.27</span> <span class="n">gnome</span><span class="o">-</span><span class="n">terminal</span><span class="o">-</span>
    <span class="mi">1</span> <span class="n">root</span>      <span class="mi">20</span>   <span class="mi">0</span>  <span class="mi">220192</span>   <span class="mi">8968</span>   <span class="mi">6852</span> <span class="n">S</span>   <span class="mf">0.3</span>   <span class="mf">0.1</span>   <span class="mi">0</span><span class="p">:</span><span class="mf">03.90</span> <span class="n">systemd</span>
  <span class="mi">563</span> <span class="n">root</span>      <span class="mi">20</span>   <span class="mi">0</span>   <span class="mi">57172</span>   <span class="mi">6336</span>   <span class="mi">5500</span> <span class="n">S</span>   <span class="mf">0.3</span>   <span class="mf">0.1</span>   <span class="mi">0</span><span class="p">:</span><span class="mf">00.64</span> <span class="n">systemd</span><span class="o">-</span><span class="n">logind</span>
</pre></div>
</div>
<p><strong>vmstat</strong></p>
<p>This less known tool is also very useful to get an overview about a lot of components from the system, but must be installed manually. The tool provides several options, but the most simple use case is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ vmstat
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 1  0  23004 790600 341872 4640592    0    2   723   581  514 1102 22  5 73  0  0
</pre></div>
</div>
<p>The default command displays summary values since the system boot. To understand all values, have a look at the man page of the tool. Below are some more examples of <code class="docutils literal notranslate"><span class="pre">vmstat</span></code> commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vmstat</span> <span class="pre">3</span> <span class="pre">10</span></code>: execute vmstat every 3 seconds for 10 times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vmstat</span> <span class="pre">-a</span></code>: display active an inactive memory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vmstat</span> <span class="pre">-s</span></code>: display a variety of event counters and statistics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vmstat</span> <span class="pre">-d</span></code>: display disk statistics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vmstat</span> <span class="pre">-S</span> <span class="pre">M</span></code>: use megabyte unit instead of kilobyte</p></li>
</ul>
<p><strong>nmon</strong></p>
<p>Global performance and system utilization interactive monitoring tool. It can be used interactively or store data in CSV files. It can collect a lot of information and present nicely: CPU, Memory, Disk Usage, Network, Processes, NFS, Kernel, etc. The panels must be toggled inside the application by pressing the corresponding letter. You can toggle help with <code class="docutils literal notranslate"><span class="pre">h</span></code>.</p>
<p>If you use always the same panels, you can load them automatically by setting the <code class="docutils literal notranslate"><span class="pre">NMON</span></code> variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NMON</span><span class="o">=</span><span class="n">cmdnk</span> <span class="n">nmon</span>
</pre></div>
</div>
</section>
<section id="processes">
<h2>Processes<a class="headerlink" href="#processes" title="Permalink to this headline">¶</a></h2>
<p><strong>htop</strong></p>
<p>It is an advanced and interactive top command. Actually it is my advised replacement for htop.</p>
<p><strong>progress</strong></p>
<p>Monitoring tool to show the progress of basic coreutils linux commands such as: cp, mv, dd, tar, gzip, …</p>
<p>The official documentation is located here: <a class="reference external" href="https://github.com/Xfennec/progress">https://github.com/Xfennec/progress</a></p>
<p>A few examples from the official documentation:</p>
<p>Monitor all current and upcoming instances of coreutils commands in a simple window:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">watch</span> <span class="n">progress</span> <span class="o">-</span><span class="n">q</span>
</pre></div>
</div>
<p>See how your download is progressing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">watch</span> <span class="n">progress</span> <span class="o">-</span><span class="n">wc</span> <span class="n">firefox</span>
</pre></div>
</div>
<p>Look at your Web server activity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">progress</span> <span class="o">-</span><span class="n">c</span> <span class="n">httpd</span>
</pre></div>
</div>
</section>
<section id="file-system-and-i-o">
<h2>File system and I/O<a class="headerlink" href="#file-system-and-i-o" title="Permalink to this headline">¶</a></h2>
<p>Some of the most useful tools for debugging file system and disk IO issues.</p>
<p><strong>iotop</strong></p>
<p>It is a live and real time monitoring of disk I/O operations per process. It shows the number of bytes read from / written to the disk, the IO capacity usaged of the media, etc. Very useful to find why your disk is slow or heavily used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ iotop
Total DISK READ :       0.00 B/s | Total DISK WRITE :       0.00 B/s
Actual DISK READ:       0.00 B/s | Actual DISK WRITE:       0.00 B/s
  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND
    1 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % init
    2 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [kthreadd]
    3 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [rcu_gp]
    4 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [rcu_par_gp]
    6 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [kworker/0:0H-kblockd]
    8 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [mm_percpu_wq]
    9 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [ksoftirqd/0]
   10 rt/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [rcu_preempt]
</pre></div>
</div>
<p><strong>lsof</strong></p>
<p>This command lists all open files and the owning process. As everything is a file in Linux, this can display disk files, processes, pipes, mqueues, devices, sockets, …</p>
<p>The default command is very verbose. Look at the man page to get some insights on what the values mean. Some useful switches:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lsof</span> <span class="pre">-u</span> <span class="pre">geoffrey</span></code>: list the files opened by the user geoffrey</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lsof</span> <span class="pre">-i</span> <span class="pre">TCP:22</span></code>: find running processes with connection on port 22</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lsof</span> <span class="pre">-i</span> <span class="pre">4</span></code>: list IPv4 network files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lsof</span> <span class="pre">-i</span> <span class="pre">6</span></code>: list IPv6 network files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lsof</span> <span class="pre">-i</span> <span class="pre">TCP:1-100</span></code>: list open connections on port range 1 to 100</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lsof</span> <span class="pre">-p</span> <span class="pre">1234</span></code>: list open files belonging to process id 1234</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ lsof
COMMAND     PID   TID TASKCMD   USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME
systemd     983                 john  cwd       DIR                8,2     4096          2 /
systemd     983                 john  rtd       DIR                8,2     4096          2 /
systemd     983                 john  txt       REG                8,2  1411208      14142 /usr/lib/systemd/systemd
systemd     983                 john  mem       REG                8,2   561040      12192 /usr/lib/libsystemd.so.0.23.0
systemd     983                 john  mem       REG                8,2   333728      41178 /usr/lib/libdbus-1.so.3.19.8
systemd     983                 john  mem       REG                8,2   133000      60752 /usr/lib/libnl-3.so.200.26.0
</pre></div>
</div>
<p><strong>iostat</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">iostat</span></code> tool reports global CPU and input / output statistics for each partition on the system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ iostat
Linux 4.18.6-arch1-1-ARCH (core-m)      09/14/2018      _x86_64_        (4 CPU)

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          21.87    0.45    5.60    0.15    0.00   71.93

Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn
sda               0.88        27.86        43.78    8422261   13232504
dm-0              0.72        23.94        40.29    7236249   12177052
</pre></div>
</div>
<p><strong>df</strong></p>
<p>This is the global disk usage analysis tool. Can be combined with <code class="docutils literal notranslate"><span class="pre">-h</span></code> for human readable data. The result is immediate - the tool doesn’t scan the file system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ df -h
Filesystem             Size  Used Avail Use% Mounted on
dev                    3.9G     0  3.9G   0% /dev
run                    3.9G  1.3M  3.9G   1% /run
/dev/sda2               14G   11G  1.8G  86% /
tmpfs                  3.9G   32M  3.9G   1% /dev/shm
tmpfs                  3.9G     0  3.9G   0% /sys/fs/cgroup
tmpfs                  3.9G  1.7M  3.9G   1% /tmp
/dev/sda3              2.0G  386M  1.5G  22% /opt
tmpfs                  788M   24K  788M   1% /run/user/120
/dev/mapper/_dev_sda4  100G   72G   23G  76% /data
tmpfs                  788M  2.6M  786M   1% /run/user/1000
</pre></div>
</div>
<p><strong>du</strong></p>
<p>This tool can give the size of a single files or directories. It will scan the disk to compute the size, so it might be slow. My best use case is <code class="docutils literal notranslate"><span class="pre">du</span> <span class="pre">-hs</span> <span class="pre">folder</span></code> to get the size of folder. Note that it will start to scan mounted device.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ du -hs source
396K    source
</pre></div>
</div>
</section>
<section id="network-stats">
<h2>Network stats<a class="headerlink" href="#network-stats" title="Permalink to this headline">¶</a></h2>
<p>The best tool to show which application is sending which amount of data is <cite>nethogs</cite></p>
<p><strong>nethogs</strong></p>
<p>The result is self-describing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NetHogs version 0.8.1

  PID USER     PROGRAM                          DEV        SENT      RECEIVED
10364 john     /usr/share/spotify/spotify       tun0       3.707      40.496 KB/sec
 9162 john     /usr/lib/gvfs/gvfsd-http         tun0       0.454       2.342 KB/sec
 8608 john     firefox                          tun0       0.000       0.000 KB/sec
 9398 john     thunderbird                      tun0       0.000       0.000 KB/sec
 8220 john     dropbox                          tun0       0.000       0.000 KB/sec
10238 john     /usr/share/spotify/spotify       tun0       0.000       0.000 KB/sec
 8224 john     /usr/bin/owncloud                tun0       0.012       0.000 KB/sec
    ? root     unknown TCP                                 0.000       0.000 KB/sec

TOTAL                                                      4.173      42.838 KB/sec
</pre></div>
</div>
<p><strong>iftop</strong></p>
<p>Live and real time network bandwidth vizualization tool. Can be useful to check network speed, see through which interface the traffic is going and to which endpoint.</p>
<p>An example use case to get the network traffic on interface <cite>eth0</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iftop</span> <span class="o">-</span><span class="n">i</span> <span class="n">eth0</span> <span class="o">-</span><span class="n">B</span>
</pre></div>
</div>
<p><strong>nload</strong></p>
<p><cite>nload</cite> is yet another traffic stats reporting connection speed. It shows current, peak and average speed with a funky animation.</p>
<p>A typical usage example for getting the network traffic on interface <cite>eth0</cite> and speed in MBytes/s:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nload</span> <span class="o">-</span><span class="n">u</span> <span class="n">M</span> <span class="n">eth0</span>
</pre></div>
</div>
</section>
<section id="network-traffic-analysis">
<h2>Network traffic analysis<a class="headerlink" href="#network-traffic-analysis" title="Permalink to this headline">¶</a></h2>
<p><strong>tcpdump</strong></p>
<p>Tcpdump could have its own dedicated TIL because it has so many options. But here are some useful simple commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tcpdump</span> <span class="pre">-i</span> <span class="pre">eth0</span></code>: capture packets from the interface eth0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcpdump</span> <span class="pre">-XX</span> <span class="pre">-i</span> <span class="pre">eth0</span></code>: display packets and its data in HEX and ASCII format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcpdump</span> <span class="pre">-w</span> <span class="pre">capture.pcap</span> <span class="pre">-i</span> <span class="pre">eth0</span></code>: save packets to a capture.pcap file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcpdump</span> <span class="pre">-r</span> <span class="pre">capture.pcap</span></code>: read from a previously saved capture file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcpdump</span> <span class="pre">-i</span> <span class="pre">eth0</span> <span class="pre">src</span> <span class="pre">172.26.10.10</span></code>: capture packets for a specific destination IP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcpdump</span> <span class="pre">-i</span> <span class="pre">eth0</span> <span class="pre">dst</span> <span class="pre">172.26.10.10</span></code>: capture packets coming from specific IP</p></li>
</ul>
<p><strong>netstat</strong></p>
<p>Netstat can monitor open ports and incoming and outgoing traffic. Below some useful commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-plunt</span></code>: list listening applications</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-a</span></code>: list all TCP and UDP ports</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-s</span></code>: statistics by protocol, ca be combined with <code class="docutils literal notranslate"><span class="pre">u</span></code> (UDP) and <code class="docutils literal notranslate"><span class="pre">t</span></code> (TCP). Can show bad segments, retransmissions, failures, …</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-at</span></code>: only TCP connections</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-au</span></code>: ony UDP connections</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-l</span></code>: all listening connections, can be combined with <code class="docutils literal notranslate"><span class="pre">u</span></code> (UDP) and <code class="docutils literal notranslate"><span class="pre">t</span></code> (TCP)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-lx</span></code>: all UNIX listening ports</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-tp</span></code>: display PID and program name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-r</span></code>: display kernel routing table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-ie</span></code>: show kernel interface table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-i</span></code>: show network interface packet statistics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-c</span> <span class="pre">10</span></code>: print continuously, every 10 seconds</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">--statistics</span> <span class="pre">--raw</span></code>: display a lot of network statistics like number of packets received, errors, …</p></li>
</ul>
<p><strong>iptraf</strong></p>
<p>More advanced iftop tool, which collects in additional and more advanced informaiton.</p>
<p><strong>arpwatch</strong></p>
<p>Monitors ARP address resolution happening on the network. Useful to debug ARP resolution on the network and ARP spoofing. It can even send e-mail alerts when addresses change.</p>
</section>
<section id="load-average">
<h2>Load average<a class="headerlink" href="#load-average" title="Permalink to this headline">¶</a></h2>
<p>Linux makes use of three “magic” numbers that get used in several of these tools to describe the load average of the system. They could be quite confusing for beginners, but actually there are easy to understand. This is one example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="n">average</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">5.09</span>
</pre></div>
</div>
<p>The numbers define the load average for the last 1 minute (1.05), the last 5 minutes (0.70) and the last 15 minutes (5.09).</p>
<p>The number defines the number of processes which are in running, waiting or uninterruptible sleep states (e.g. waiting for I/O). The number have to be compared to the number of CPU on the system.</p>
<p>So if the example above is a system with 2 CPUs, it means that the system is fully loaded when the value is equal 2:
* over the last minute, the system was mostly idle
* over the last 5 minutes, it was half used
* over the last 15 minutes, it was overloaded: there were many processes waiting for the CPU</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="package-managers.html" class="btn btn-neutral float-right" title="Enable “Tap to click” touch pad" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mount.html" class="btn btn-neutral float-left" title="Mount" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Geoffrey Papaux

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pacman: reinstall packages and their dependencies from update &mdash; Geoffrey&#39;s TIL 0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Remove unused locales" href="remove-unused-locales.html" />
    <link rel="prev" title="Pacman: maintenance" href="pacman-maintenance.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Geoffrey's TIL
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ansible/_.html">Ansible</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_.html">ArchLinux</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gnome-autostart-script.html">Gnome: autostart script</a></li>
<li class="toctree-l2"><a class="reference internal" href="pacman-aur-packages-list.html">Pacman: list packages from AUR</a></li>
<li class="toctree-l2"><a class="reference internal" href="pacman-clean-cache.html">Pacman: clean cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="pacman-downgrade-package.html">Pacman: Downgrade package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pacman-find-which-package-installed-file.html">Pacman: find which package installed a file</a></li>
<li class="toctree-l2"><a class="reference internal" href="pacman-list-packages-by-size.html">Pacman: list packages by size</a></li>
<li class="toctree-l2"><a class="reference internal" href="pacman-maintenance.html">Pacman: maintenance</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pacman: reinstall packages and their dependencies from update</a></li>
<li class="toctree-l2"><a class="reference internal" href="remove-unused-locales.html">Remove unused locales</a></li>
<li class="toctree-l2"><a class="reference internal" href="system-installation-date.html">System installation date</a></li>
<li class="toctree-l2"><a class="reference internal" href="yaourt-noconfirm.html">Yaourt: noconfirm</a></li>
<li class="toctree-l2"><a class="reference internal" href="yay.html">Yay: installer for AUR packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bash/_.html">Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/_.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-env/_.html">Development environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/_.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/_.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java/_.html">Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/_.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kvm/_.html">KVM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/_.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../markdown/_.html">Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/_.html">Media</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mysql/_.html">Mysql</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/_.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodejs/_.html">NodeJS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../php/_.html">PHP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postgres/_.html">Postgres</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/_.html">Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/_.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sphinx/_.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scala/_.html">Scala</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tmux/_.html">tmux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ubuntu-debian/_.html">Ubuntu / Debian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vim/_.html">vim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/_.html">Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wine/_.html">Wine</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Geoffrey's TIL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_.html">ArchLinux</a> &raquo;</li>
        
      <li>Pacman: reinstall packages and their dependencies from update</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/archlinux/pacman-reinstall-with-deps.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pacman-reinstall-packages-and-their-dependencies-from-update">
<h1>Pacman: reinstall packages and their dependencies from update<a class="headerlink" href="#pacman-reinstall-packages-and-their-dependencies-from-update" title="Permalink to this headline">¶</a></h1>
<p>In case something went wrong with your last update (disk full while updating, some lost dependencies, update aborted, computer crashed…) you can use the following commands to reinstall all packages with their dependencies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>UPGRADE_DATE=2017-04-24
PATTERN=[\[]${UPGRADE_DATE}.*upgraded
grep -a $PATTERN /var/log/pacman.log | sed -e &#39;s/.*upgraded //&#39; \
 | sed -e &#39;s/ (.*)$//&#39; | xargs -n1 pactree -u | sort | uniq | \
 xargs sudo pacman -S
</pre></div>
</div>
<p>Some details about the command:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">UPGRADE_DATE</span></code> put here the date when you did the upgrade</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">-a</span></code> because my /var/log/pacman.log was considered as binary file by grep</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pactree</span></code> is used to get the list of dependencies from a package (might take some time depending on the update size)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span></code> and <code class="docutils literal notranslate"><span class="pre">uniq</span></code> because we get the dependencies of all packages, so we filter</p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="remove-unused-locales.html" class="btn btn-neutral float-right" title="Remove unused locales" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pacman-maintenance.html" class="btn btn-neutral float-left" title="Pacman: maintenance" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Geoffrey Papaux

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>